@model CheckoutViewModel

<!DOCTYPE html>
<html>
<head>
    <title>Checkout - Dunder Mifflin</title>
    <link rel="stylesheet" asp-href-include="/lib/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" asp-href-include="/lib/font-awesome/css/all.min.css" />
    <link rel="stylesheet" asp-href-include="/css/custom.css" />
</head>
<body>
    <header class="container-fluid">
        <nav class="navbar navbar-expand-md shadow fixed-top bg-primary navbar-dark">
            <a class="navbar-brand ms-1" asp-action="Index" asp-controller="Home">Dunder Mifflin Paper Company</a>
        </nav>
    </header>
    <main class="container">
        @if (TempData["Message"] != null)
        {
            <div class="d-flex justify-content-center" id="disappearingAlert" style="width:100%;position:fixed;left:0;">
                <div class="alert alert-dismissible alert-danger" role="alert">
                    @TempData["Message"]
                    <button type="button" class="ms-3 p-0 btn-close" style="position: inherit;padding: 0;align-self: center;"
                            data-bs-dismiss="alert" aria-label="Close">
                    </button>
                </div>
            </div>
        }
        <div class="d-flex justify-content-between">
            <h4 class="ms-3">Review your order</h4>
            <a><i class="fa-solid fa-shopping-cart"> Back to cart</i></a>
        </div>
        <form asp-action="Add" asp-controller="Order" method="post">
            <div class="row mt-4">
                <div class="col-md-9">
                    <div class="bg-white px-3 py-3">
                        <p>Delivery Method</p>
                        <input type="radio" name="DeliveryMethod" value="0" id="Delivery" />
                        <label for="Delivery"> Delivery</label>
                        <input type="radio" name="DeliveryMethod" value="1" id="Collection" />
                        <label for="Collection"> Collection</label>
                    </div>
                    <div class="bg-white px-3 py-3">
                        <div class="d-flex justify-content-between">
                            <p>Delivery Address</p>
                            <a asp-action="" asp-controller="" class="btn btn-primary">Add Address</a>
                        </div>
                        <hr />
                        @{
                            int index = 0;
                        }
                        @foreach (Address address in Model.Addresses.Take(2))
                        {
                            <input type="radio" name="addressID" id="@($"address{index}")" value="@index" />
                            <label for="@($"address{index}")"><strong>@address.ShortDescription</strong></label>
                            <hr style="color:grey" />
                            index++;
                        }
                        @if (Model.Addresses.Count > 2)
                        {
                            <a id="showMore" onclick="ShowMore('more')">Show More</a>
                            <div id="MoreAddresses" hidden>
                                @for (int i = index; i < Model.Addresses.Count; i++)
                                {
                                    <input type="radio" name="addressID" id="@($"address{index}")" value="@index" />
                                    <label for="@($"address{index}")"><strong>@Model.Addresses[i].ShortDescription</strong></label>
                                    <hr style="color:grey" />
                                }
                            </div>
                            <a id="showLess" onclick="ShowMore('less')" hidden>Show Less</a>
                        }

                    </div>
                </div>
                <div class="col-md-3 bg-white px-3 py-3" style="height:fit-content;">
                    <h5 class="text-secondary mb-2">Order Summary</h5>
                    <div class="mt-3 mb-3 d-flex justify-content-between">
                        <div class="d-flex align-items-end" style="font-size:small;">
                            <strong>Total:&nbsp;</strong>(@Model.Products.Sum(cartProducts=>cartProducts.PurchaseQuantity) items)
                        </div>
                        <h4 class="text-success mb-0">
                            R <span id="total">@Model.Products.Sum(cartProducts => cartProducts.totalPrice)</span>
                        </h4>
                    </div>
                    <button class="btn btn-success d-grid w-100" type="submit">Place Order</button>

                </div>
            </div>
        </form>

    </main>
    <script asp-src-include="/js/checkout.js"></script>
</body>
</html>
